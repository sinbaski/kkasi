rm(list = ls());
library("expm");
## A = matrix(rt(12, 1)^2, 3, 4);
## B = matrix(rt(12, 1)^2, 4, 3);
## C = matrix(rt(9, 1)^2, 3, 3);
## M <- A %*% B + C;
## M <- M + C %*% A %*% B;
## M <- M %*% (C %^% 2) + M %*% ((A %*% B) %^% 3)

## A <- matrix(c(1.7533e+15, 2.0030e+14, 1.546e-29, 0), 2, 2);
## B <- matrix(c(1 ,2, 3, 4), 2);
## M <- A %*% B;
## M <- M %*% A;
## M <- M + B + A %*% A;


A <- matrix(NA, 2, 3);
B <- matrix(NA, 3, 2);
A[1, 1] = 1.2;
A[1, 2] = 0.9;
A[1, 3] = 0.01;
A[2, 1] = 1.5;
A[2, 2] = 2.2;
A[2, 3] = 0;

B[1, 1] = 3.9;
B[1, 2] = 0.3;
B[2, 1] = 10.19;
B[2, 2] = 1.22;
B[3, 1] = 1.2e-3;
B[3, 2] = 6.5;

C <- A %*% B;
M <- C;
for (i in 2:10) {
    M <- M %*% C;
}
