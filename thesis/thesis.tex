\documentclass{report}
\usepackage{graphicx}
\usepackage{subfigure}
\usepackage{multirow}
\usepackage{wrapfig}
\usepackage{amssymb}
\usepackage{amsfonts, amsmath}
\usepackage{mathrsfs}
\usepackage{enumerate}
\usepackage[bookmarks=true]{hyperref}
\usepackage{bookmark}

\input{../physics_common.tex}
\DeclareGraphicsExtensions{.pdf,.png,.jpg}

% \title{Stocks' Cross-Correlations}
% \subtitle{}

\author{Xie Xiaolei}
\date{\today}
\begin{document}

\begin{titlepage}
\begin{center}

% Upper part of the page. The '~' is needed because \\
% only works if a paragraph has started.
\includegraphics[width=0.5\textwidth]{../pics/lund_uni-logo_s}~\\[1cm]

% \textsc{\LARGE Lund University}\\[1.5cm]

\textsc{\Large Master's Thesis Project}\\[0.5cm]

% Title
%\HRule \\[0.4cm]
{ \huge \bfseries A Comparison of GARCH and Stochastic Volatility Models in
  the Study of Intraday Returns \\[0.4cm] }

%\HRule \\[1.5cm]

% Author and supervisor
\begin{minipage}{0.4\textwidth}
\begin{flushleft} \large
\emph{Author:}\\
\textsc{Xie} Xiaolei
\end{flushleft}
\end{minipage}
\begin{minipage}{0.4\textwidth}
\begin{flushright} \large
\emph{Supervisor:} \\
Prof. Sven \textsc{\AA berg}
\end{flushright}
\end{minipage}

\vfill

% Bottom of the page
{\large \today}

\end{center}
\end{titlepage}
% \maketitle
\tableofcontents

\chapter{Introduction}
The mathematics of the financial market has always been a topic that
arouses interest and imagination, and with no doubt, has been
studied from many aspects and in many different ways.

Central to all these studies are the concepts of probability
distributions and correlations. The values of stocks, futures,
options, etc. are stochastic in nature and are governed by the laws of
stochastic processes, which are expressed in terms of probability
distributions and correlations.

Meanwhile, the observables of the market are prices, volumes,
turn-over (the amount of money paid in a trade), names of the brokers,
and time of the trades. These quantities don't make much sense
by themselves but do reveal the probabilistic dynamics of the market
when put together and turned into statistics.

Here by dynamics we mean how the value of an asset is affected by its
own history as well as by the histories and current values of other
assets in the market. The influence from the asset's own history is
termed autocorrelations, i.e. correlations in time, while
the influence from other assets are termed cross correlations.

Mathematical models that describe the aforementioned observables in
terms of probability distributions, autocorrelations and cross
correlations give predictive power and help determine a fair price of
a given asset. Hence they are a central topic of the mathematics of
the financial market.

Once a model has been tentatively constructed, it must be
verified. The verification again relies on the statistics of the
observables. Over the years, a number of phenomena have been
consistently reported and become generally accepted. These are referred
to as stylized facts, which are detailed in \S
\ref{sec:StylizedFacts} and constitute a standardized test suit for
model verification.

The rest of this report is organized as follows: in
\S\ref{sec:FundamentalConcepts} we present a few very important
concepts and notations that we will often refer to in later
chapters; in chapter \ref{chp:nordea_15min} we study 15-minute returns
of Nordea Bank during the period 2012/01/16 - 2012/04/20, using GARCH
and stochastic volatility models; in chapter \ref{chp:Nordea2} we
study 15-minute and 30-minute returns of Nordea Bank in the period
2013/10/10 - 2014/04/04; and in chapter \ref{sec:volvo} we look at
15-minute and 30-minute returns of Volvo B in the same period.

In chapter \ref{chp:SLV_unconditional} a calculation of the
unconditional distribution functions of a stochastic volatility model
is presented. The results are checked against 30-minute returns of
Nordea Bank, Volvo B and Ericsson B. Finally chapter \ref{chp:summary2}
concludes the report.

In these studies we approximate the conditional volatility with the
``realized volatility'', which is computed from higher-frequency
returns \cite{Mikosch2009}.
The intraday returns involved in the studies are calculated from
minute-by-minute average prices recorded in the Stockholm Stock
Exchange (OMX). If no transaction is record in a interval $[t, t +
\Delta t]$, the average price of the previous interval $[t - \Delta t,
t]$ is assumed.

\section{Fundamental Concepts \& Notations}
\label{sec:FundamentalConcepts}
This section is a list of a few concepts that may be unfamiliar to the
reader and that we will often refer to later in the thesis:
\begin{itemize}
\item Return. Given a fixed time interval $[t - \Delta t, t]$, for example, a
  day, a week, a month, etc, and a particular asset, for example, a
  share in company ABC, the return of this asset over the time
  interval is defined as
  \begin{eqnarray*}
    r_{t, \Delta t} &=& \ln p_{t} - \ln p_{t - \Delta t} \\
    &=& \ln \left(1 + {p_{t} - p_{t - \Delta t} \over p_{t - \Delta t}}\right) \\
    &\approx& {p_{t} - p_{t - \Delta t} \over p_{t - \Delta t}}
  \end{eqnarray*}
  where $p_t$ is the price of the asset at time $t$. $\Delta t$ is
  sometimes called the time-lag of the return. Quite often, where
q  confusion is not possible, we will just write $r_t$ to mean $r_{t,
    \Delta t}$, the time lag either does not matter or is clear from
  the context.

\item Autocorrelation. By autocorrelation, denoted $\rho_k$ here, we
  mean the correlation between two temporally separated observations
  of the same time series:
  \begin{eqnarray*}
    \rho_k &=& {
      \E\left[(a_t -\E(a_t))(a_{t-k} - \E(a_{t-k})\right]
      \over
      \sqrt{\text{var}(a_t)}\sqrt{\text{var}(a_{t-k})}
    }
  \end{eqnarray*}
  Here $\E(x)$ stands for the expectation value of $x$, and
  $\text{var}(x)$ stands for the variance of $x$. $k$ is called the
  time-lag and is the temporal seperation of the two observations
  measured by the number of observations in between. For example, the
  time-lag between the 1st and 3rd observation is 2.

\item Cross-Correlation Matrix. Correlations between the returns of a
  group of assets are described by the cross-correlation matrix. When
  the asset returns are described by a stable distribution law with
  L\'evy index $\alpha$, the empirical cross-correlation matrix is
  constructed as
  \begin{equation}
    \label{eq:cross-correlation}
    \begin{aligned}
      C_{ij} &= {1 \over T^{2/\alpha}} \sum_{t=1}^T [r_{i,t}-\E(r_i)]
      [r_{j,t}-\E(r_j)] \\
      &= {1 \over T^{2/\alpha}} RR'
    \end{aligned}
  \end{equation}
  where $r_{i,t}$ is the return of the i-th asset at time t and is
  placed at the entry (i, t) of matrix R; $R'$ denotes the
  transpose of R. In most practical situations, one has abundant data
  for each and every asset. Thus $T \geq N$ is assumed throughout this
  thesis.

\item Auto-regressive processes. A time series $r_t$ is called an
  auto-regressive process of order $p$ and denoted AR(p), if it can be
  written in the following form:
  \begin{eqnarray*}
    r_t &=& \sum_{i=1}^p \phi_i r_{t-i} + a_t
  \end{eqnarray*}
  where, for all $i$, $\phi_i \in (-1, 1)$, and the $a_t$'s are
  independent and identically distributed (iid.) random variables with
  zero mean. Obviously this implies the mean of $r_t$ is zero
  too. Apart from this, their distribution of $a_t$ is not restricted
  to any particular form.
  
  Of particular interest to this thesis is the AR(1) process:
  \begin{eqnarray*}
    r_t = \phi r_{t-1} + a_t
  \end{eqnarray*}
  Its autocorrelation function $\rho_k = \text{corr}(r_t, r_{t-k})$
  ($k = 0, 1, 2, \cdots$) can be easily shown to fall off
  exponentially:
  \begin{eqnarray*}
    \rho_k &=& {\E(r_tr_{t-k}) - \E(r_{t-k})\E(r_{t}) \over
      \sqrt{\var(r_t) \var(r_{t-k})}} \\
    &=& {\phi \E(r_{t-1}r_{t-k}) + \E(a_t r_{t-k})
      \over
      \sqrt{\var(r_t) \var(r_{t-k})}
    } \\
    &=& \phi \rho_{k-1}
  \end{eqnarray*}
  where $\E(a_t r_{t-k}) = 0$ follows from the fact that any return
  $r_{t1}$ must not depend on disturbances $a_{t2}$ that occur later
  in time. The last equation means $\rho_k$ is a geometric series. Since
  $\rho_0 = 1$, we have
  \begin{eqnarray*}
    \rho_k &=& \phi^k \\
    |\rho_k| &=& e^{k\ln|\phi|} \\
  \end{eqnarray*}
  Note that $|\phi| < 1$ and hence $\ln|\phi| < 0$.

  Although $k$ can only take integer values, it is still useful to
  define a correlation time $\tau$ such that $\phi^\tau = 1/2$. Such a
  quantity is more intuitive and constitutes a measure of
  autocorrelations that is universal and comparable among different
  time series' models. From the definition of $\tau$ we get
  \begin{equation}
    \label{eq:tau_def}
    \begin{aligned}
      \phi^\tau &= 1/2 \\
      \tau &= -{\ln 2 \over \ln\phi} \\
      \phi &= 2^{-1/\tau}
    \end{aligned}
  \end{equation}
  Figure \ref{fig:AR1-autocorrelation} shows the autocorrelation
  function of the AR(1) model. As proven above, this function decays
  exponentially.
  \begin{figure}[htb!]
    %\vspace{-15mm}
    \centering
    \includegraphics[scale=0.5, clip=true, trim=113 229 115
    139]{../pics/AR1-autocorrelation.pdf}
    \caption{\small \it Autocorrelation function of the AR(1) model
      with $\phi=1/\sqrt{2}$. Red circles: autocorrelations at $k=0, 1,
      2, \cdots$. Blue line: $e^{t\ln\phi}$.}
    \label{fig:AR1-autocorrelation}
  \end{figure}
  For more details about conventional time series' models, see
  \cite{BoxJenkins94}.
\end{itemize}

For purposes of later reference, we also list some notations that may
cause confusion to the reader:
\begin{itemize}
\item $\E(x)$ or $\mean{x}$: The expectation value of $x$.
\item $\var(x)$: the variance of $x$.
\item $\text{cov}(x,y)$: the covariance of $x$ and $y$.
\item $\text{corr}(x,y)$: the correlation between $x$ and $y$, i.e.
  \begin{equation*}
    \text{corr}(x,y) = {\text{cov}(x,y) \over \sqrt{\var(x)\var(y)}}
  \end{equation*}
\end{itemize}

\section{Stylized facts}\label{sec:StylizedFacts}
This section presents and explains a few ``stylized facts'',
i.e. phenomena that are widely observed and accepted as true.
\begin{itemize}
\item Fat tails. It has been consistently reported by various studies
  - for example \cite{Potters2003} and \cite{Mantegna2000} - that the
  probability density function (PDF) of stock/index returns are not
  Gaussian. Unlike the Gaussian PDF, which is symmetric and falls off
  very quickly as its argument moves from the center to the outskirts
  (tails), the PDF of stock/index returns are higher on the tails,
  i.e. the probability of large fluctuations is higher than is dictated
  by a Gaussian distribution - in fact, even higher than dictated by
  an exponential function. Empirical studies suggest the distribution
  function of the returns follows a power-law on the tails --- the
  exponent of the power depends on the specific stock/index.

  Figure \ref{fig:FatTail} illustrates this feature.
  \begin{figure}[htb!]
    \centering
    \includegraphics[scale=0.6, clip=true, trim=92 229 110
    140]{../pics/FatTail.pdf}
    \caption{\small \it Fat tails of {\it Nordea Bank} 15-minute
      returns during the period 2013-10-10 and 2014-01-29. The returns
      are computed using minute-by-minute average prices.}
    \label{fig:FatTail}
  \end{figure}

\item Non-zero skewness. Apart from fat tails, the PDF of stock/index
  returns are often also skewed. If the skewness is positive
  (negative), the probability of very large positive (negative)
  returns is higher than that of very large negative (positive)
  returns, even though the mean of the returns is 0 or extremely
  close to 0.

  Table \ref{tab:EmpiricalSkewness} lists the skewness of a few
  Swedish stocks traded on the Stockholm OMX market.
  \begin{table}[htb!]
    \footnotesize
    \centering
    \begin{tabular}{|c|c|c|c|c|c|c|}
      \hline
      Nordea Bank & Volvo B & Boliden & ABB Ltd & H\&M & Scania
      B & Ericsson B \\
      \hline
      0.1362 & 0.0471 & 0.0567 & -0.0364 & -0.0168 &
      -1.1554 & 0.2086 \\
      \hline
    \end{tabular}
    \caption{\small \it Skewness of Stock Returns. All the returns
      have time-lag of 15 minutes and are computed using paid prices
      between 2013-10-10 and 2014-01-29. }
    \label{tab:EmpiricalSkewness}
  \end{table}

\item Higher-order autocorrelation. To the lowest order, return series
  are not auto-correlated --- if they are, the auto-correlations would
  present an obvious opportunity of making easy profit and be
  exploited and vanish as soon as they appear. However, the squared
  returns do have significant auto-correlations, as figure
  \ref{fig:nordea_15min_acf} illustrates. These auto-correlations
  suggest the variances of the returns at subsequent time steps are
  correlated. These are referred to as higher-order
  auto-correlations.
\end{itemize}

\section{GARCH models}
``GARCH'' is the acronym for ``Generalized Autoregressive Conditional
Heteroscedasticity''. A GARCH(p, q) model is defined by the following
equation system:
\begin{equation}
  \label{eq:garch_def}
  \begin{aligned}
    r_t &= \mu + \epsilon_t \\
    \sigma_t^2 &= \alpha_0 + \sum_{i=1}^q \alpha_i \epsilon_{t-i}^2 +
    \sum_{i=1}^p \beta_i \sigma_{t-i}^2
  \end{aligned}
\end{equation}
where $\epsilon_t$ is termed the innovation of the return $r_t$ and is
a random variable of a prescribed distribution, the most common ones
being Gaussian, Student's t, Asymmetric Student's t, etc; $\sigma_t^2$
is the variance of $\epsilon_t$ \cite{Bollerslev86}. The
autocorrelation function of $\epsilon_t^2$ is given by
(c.f. \cite{Bollerslev87})
\begin{eqnarray*}
\rho_n &=& \sum_{i=1} ^{p \vee q} (\alpha_i + \beta_i) \rho_{n-i}
\text{ for $n > p$}
\end{eqnarray*}
where $\alpha_i$ with $i > q$ and $\beta_i$ with $i > p$ are taken as
zeros. $p \vee q$ denotes the maximum of p and q. From these
equations, it is clear that the partial autocorrelation function cuts
off at $\max(p, q)$.

\section{Stochastic Volatility Models}\label{sec:SLV_model}
With the availability of transaction data, estimating conditional
volatility using returns sampled at a higher frequency (realized
volatility) gives superior acuracy and reliability. However, at which
frequency the time series should be sampled in order to give an
unbiased and consistent estimate of the volatility is not a trivial
question. Naively one would argue by the doctrine of statistics that
the often the series is sampled, the better the estimate. This is also
well supported in theory, since the quadratic variation which is the
theoretial variance of the time series (see \cite{Andersen03}, theorem
1 and corollary 1), is approximated as (see \cite{Protter05}, ch.II,
\S6, theorem 22):
\[
\var(p_{t+h} - p_t) = [r, r]_{t+h} - [r, r]_t = \lim_{n \to \infty}
\sum_{T^i \in \pi_n} (p^{T_{i+1}} - p^{T_i})^2
\]
where $p_t$ is the log price process and $r_t = p_t - p_0$. $\pi_n$
is a refining partition of the interval $[t, t+h]$.

However, due to the noise introduced by market micro-structure, there
is actually an optimal sampling frequency relative to $h$. While the
method to determine this optimal frequency is a subject of debate (see
for example \cite{Sahalia05}), it is not difficult to find a fairly
satisfactory frequency in practice.

Andersen and Bollerslev et al proved in \cite{Andersen03} that, with
the conditional volatility well approximated by the realized
volatility, $r_{t+h, h} = p_{t+h} - p_t$ is governed by a Gaussian
distribution (see theorem 2 of \cite{Andersen03}):
\[
r_{t+h, h} | \sigma(\mu_{t+s}, \sigma_{t+s})_{s \in [0, h]} \sim
N(\int_{0}^h \mu_{t+s} ds, \int_{0}^h \sigma_{t+s}^2 ds)
\]

Thus in practice one can try a few frequencies and compare the
distribution of $r_{t+h, h}/\hat{\sigma}_{t+h, h}$ with the standard
Gaussian. If the two match, $\hat{\sigma}_{t+h, h}$ is a good estimate
of $\sigma_{t+h, h}$, the volatility of $r_{t+h, h}$.

Now that the computation of realized volatility is clear, we specify
the model of the return and the log-volatility:
\begin{eqnarray}
   r_{t+h, h} &=& \ln p_{t+h} - \ln p_t \nonumber \\
   r_{t+h, h} &=& \mu + \sigma_{t+h, h} b_t \label{eq:SLV_spec}
\end{eqnarray}
where $p_t$ is the price of the asset at time $t$ and $b_t \sim N(0,
1)$. For simplicity, in the rest of this chapter we shall just write
$t$ for the subscript ``t+h, h'', since the time interval $h$ is fixed
for each time series and is a known constant. In the later chapters,
we show that $\ln \sigma_t$ can be well described by ARIMA models.

% \input{price_models}
% \input{cross_correlation_gaussian}
% \input{GARCH_correlation}
% \input{summary.tex}

\input{Nordea_15min}
\input{NordeaVolvo}
\input{SLV_Unconditional}
\input{summary2}

\bibliographystyle{plain}
\bibliography{econophysics}
\end{document}


