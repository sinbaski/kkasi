\documentclass{article}
\usepackage{amsmath}
\usepackage{amsthm}
\usepackage{enumerate}
\usepackage[bookmarks=true]{hyperref}
\usepackage{bookmark}
\usepackage{graphicx}

\input{../../physics_common}

\newtheorem{theorem}{Theorem}
\newtheorem{lemma}{Lemma}
\theoremstyle{remark}
\newtheorem{remark}{Remark}

\title{Importance Sampling}
\author{Xie Xiaolei}
\date{\today}

\begin{document}
\maketitle
\section{Introduction}
We consider the model
\begin{eqnarray*}
V_n &=& A_n V_{n-1} + B_n\\
\end{eqnarray*}
Use the following notations
\begin{eqnarray*}
X_n &=& {
        A_n A_{n-1} \cdots A_1 \tilde V_0
        \over
        |A_n A_{n-1} \cdots A_1 \tilde V_0|
        } \\
S_n &=& \log |A_n \cdots A_1 \tilde V_0| \\
\xi_n &=& S_n - S_{n-1} = \log\frac{|A_n \cdots A_1 \tilde V_0|}{|A_{n-1}
  \cdots A_1 \tilde V_0|} \\
&=& \log\left| A_n \frac{A_{n-1} \cdots A_1 \tilde V_0}
    {|A_{n-1} \cdots A_1 \tilde V_0|} \right|\\
&=& \log |A_n X_{n-1}|
\end{eqnarray*}
The pair $(X_n, S_n)$ is a Markov additive process with transition
kernel $P$. Assume conditions (M) and (A) of Kesten \cite{Kesten1973}:
\begin{enumerate}
  \item $\P(A > 0) = 1$, $\P(B \geq 0) = 1$, $\P(B = 0) < 1$.
   
\item
  \begin{enumerate}
  \item The top Lyapunov exponent is negative, i.e.
    \begin{equation}
      \label{eq:neg_top_Lyapunov}
      \inf_{n \geq 1} \E \log \|A_n \cdots A_1\| < 0    
    \end{equation}
  \item $\exists \xi > 0$ such that $\lambda(\xi) = 1$, where
    $$
    \lambda(\xi) := \inf_{n \geq 1} (\E \|A_n \cdots A_1\|^\xi)^{1/n}
    $$
    \item $\exists \epsilon > 0$ such that $\E \|A\|^{(1 + \epsilon)\xi} <
      \infty$ and $\E |B|^{(1 + \epsilon)\xi} < \infty$.
  \end{enumerate}
  \item The additive subgroup of $\mathbb R$ generated by
    \[
    \{\log \rho(\pi): \pi = \prod_{i=1}^n A_i \text{for some n and
      iid. } A_i\}.
    \]
    is dense in $\mathbb R$. Here $\rho(\pi)$ denotes the largest
    singular value of $\pi$.
\end{enumerate}

\section{Consistency}\label{sec:consistency}
By the law of large numbers
\begin{eqnarray*}
  && \P(|V| > u) \\
  &=& \lim_{n \to \infty} {1 \over n} \sum_{i=0}^n \1{|V_i| > u}
\end{eqnarray*}
Define
\[
R_n := \inf\{0 \leq i \leq n: V_i \in \mathcal C\}
\]
and
\[
K_i := \inf\{k \geq 1: k > K_{i-1}, V_k \in \mathcal C, K_0 = 0\}
\]
Then one can write
\begin{eqnarray*}
  && \lim_{n \to \infty} {1 \over n} \sum_{i=1}^n \1{|V_i| > u} \\
  &=& \lim_{n \to \infty} {1 \over n} \left[
    \sum_{i=0}^{K_{R_n}-1} \1{|V_i| > u} + \sum_{i=K_{R_n}}^n \1{|V_i| > u}
\right]
\end{eqnarray*}
For the 2nd term, by a Borel-Cantelli argument, it maybe shown
\[
\lim_{n \to \infty} {1 \over n}\sum_{i=K_{R_n}}^n \1{|V_i| > u} = 0
\]
For the 1st term,
\begin{eqnarray*}
&& \lim_{n \to \infty} {1 \over n} \sum_{i=0}^{K_{R_n}-1} \1{|V_i| >
  u}  \\
&=& \lim_{n \to \infty} {R_n \over n} {1 \over R_n} \sum_{i=1}^{R_n}
\sum_{j=K_{i-1}}^{K_i-1}\1{|V_i| > u} \\
&=& \pi(\mathcal C) \E_\gamma N_u
\end{eqnarray*}
where the law of large numbers of Markov chains has been used to reach
the last line. In addition, it is assumed
\begin{eqnarray*}
  V_{K_i} &\sim& \gamma \; \forall i \geq 0 \\
  \gamma(E) &=& \pi(E)/\pi(\mathcal C)\; \forall E \in \mathcal
  B(\mathcal C)
\end{eqnarray*}
Define
\begin{eqnarray*}
  T_u &=& \inf\{n \geq 1: |V_n| > u\} \\
  \tau &\overset{d}{=}& K_i - K_{i-1} \\
  N_u &:=& \sum_{i=0}^{\tau-1} \1{|V_i| > u}  \\
\end{eqnarray*}
Then $\E_\gamma N_u$ may be evaluated as
\begin{eqnarray*}
  && \E_\gamma N_u \\
  &=& \E_\gamma N_u \1{T_u < \tau} \\
  &=& \int_{\mathds S^{d-1}} \int_{\mathds R} \cdots \int_{\mathds
    S^{d-1}} \int_{\mathds R} N_u \1{T_u < \tau} \times \\
  && \prod_{i=1}^{T_u} e^{-\xi(s_i - s_{i-1}) + \lambda(\xi)}
  {r(x_{i-1}; \xi) \over r(x_{i}; \xi)}P_\xi(x_{i-1}, dx_i \times ds_i) \times \\
  && \prod_{i=T_u+1}^{\tau-1} P(x_{i-1}, dx_i \times d s_i) \\
  &=& \E_{\mathcal D} \left[
    N_u \1{T_u < \tau} e^{-\xi S_{T_u}} {r(\tilde V_0; \xi)
      \over r(x_{T_u}; \xi)}
  \right]
\end{eqnarray*}
where
\[
P_\xi(x_{i-1}, dx_i \times ds_i) = e^{\xi(s_i - s_{i-1}) -
  \lambda(\xi)} {r(x_i; \xi) \over r(x_{i-1}; \xi)} P(x_{i-1}, dx_i
\times ds_i)
\]
is the $\xi$-shifted transition kernel of the {\it Markov Additive
  process} $(X_n, S_n)$. $\xi$ is chosen such that 
\[
\lambda(\xi) = \lim_{n \to \infty} \log \left(
\E \|A_n \cdots A_1\|^\xi
\right)^{1/n} = 0
\]
$\E_{\mathcal D}$ denotes expectation taken with respect to the dual
measure defined as
\[
P_{\mathcal D} (x_i, dx_{i+1} \times ds) = \left\{
  \begin{array}{ll}
    P_\xi (x_i, dx_{i+1} \times ds) & \text{ if } i < T_u \\
    P(x_i, dx_{i+1} \times ds) & \text{ if } i \geq T_u \\
  \end{array}
\right.
\]
Because the top Lyapunov exponent is negative, it follows from a lemma
in Kesten \cite{Kesten1973} that there is a $s > 0$ such that
$\lambda(s) < 0$.

Thus we have obtained a consistent estimator
$\pi(\mathcal C)\mathcal E_u$ for $\P(|V| > u)$:
\begin{eqnarray*}
\P(|V| > u) &=& \pi(\mathcal C) \E_{\mathcal D} \mathcal E_u \\
&=& \pi(\mathcal C) \E_{\mathcal D} \left[
  N_u \1{T_u < \tau} e^{-\xi S_{T_u}} {r(\tilde V_0; \xi)
    \over r(x_{T_u}; \xi)}
\right]
\end{eqnarray*}

\section{Efficiency}\label{sec:efficiency}
\begin{lemma}
  Let $\beta \in \mathbb R$ satisfy
  \begin{enumerate}
  \item
    \begin{equation}
      \label{eq:drift_cond1}
      \E \|A\|^\beta < \infty      
    \end{equation}
  \item 
    \begin{equation}
      \label{eq:drift_cond2}
    \inf_{\alpha > 0} {\E \|A\|^{\alpha + \beta}
      \over 
      \E \|A\|^{\beta}
    } < 1
    \end{equation}
  \end{enumerate}
  then $\forall \alpha > 0$ such that $\frac{\E\|A\|^{\beta +
      \alpha}}{\E\|A\|^\beta} < 1$ , we have
  \begin{equation}
    \label{eq:drift}
    \E_\beta \left[\left.
        |V_n|^\alpha r_\beta(|\tilde V_n|; \alpha) \I{{\mathcal C}^\complement}(V_{n-1}) \right|
      \mathcal F_{n-1} \right] \leq |V_{n-1}|^\alpha r_\beta(|\tilde
    V_{n-1}|; \alpha) \I{{\mathcal C}^\complement}(V_{n-1})
  \end{equation}
  where $r_\beta(\cdot; \alpha)$ is the unique right eigen function of the
  operator
  \[
  P_{\alpha, \beta} f(x) = \int |\hat a x|^\alpha f\left(
    {\hat a x \over |\hat a x|}
  \right) d\mu_A^\beta(\hat a)
  \]
  where the $\beta$-shifted measure $\mu_A^\beta$ satisfies
  \[
  d\mu_A^\beta(\hat a) = {\|\hat a\|^\beta d\mu_A(\hat a) \over \E\|A\|^\beta}
  \]
\end{lemma}

\begin{proof}
  Conditions \eqref{eq:drift_cond1} and \eqref{eq:drift_cond2} imply $\E_\beta
  \|A\|^\alpha < \infty$. Then, using the results of Buraczewski and
  Collamore et al \cite{BCDZ2014}, one may conclude that an eigen
  function $r_\beta(\cdot; \alpha)$ as well as an eigen measure
  $l_\beta(\cdot; \alpha)$ exists under the $\beta$-shifted
  measure. Thus, by defining the adjoint operator under  the shifted
  measure, the right eigen function $r_\beta(x; \alpha)$ can be represented as
  \[
  r_\beta(x; \alpha) = c \int_{S_+^{d-1}} \inn{x, y}^\alpha
  dl^*_{\beta}(x; \alpha)
  \]
Now, to prove \eqref{eq:drift}, consider
  \begin{eqnarray*}
    && \E_\beta \left[ |V_n|^\alpha r_\beta(\tilde V_n; \alpha) | \mathcal F_{n-1} \right]
    \\
    &=& \E_\beta\left[\int_{S_+^{d-1}} \inn{V_n, y}^\alpha dl^*_{\beta}(y; \alpha)|
      \mathcal F_{n-1} \right]
    \\
    &=& \E_\beta\left[\int_{S_+^{d-1}} (\inn{A_n V_{n-1}, y} + \inn{B_n,
        y})^\alpha dl^*_{\beta}(y; \alpha) | \mathcal F_{n-1} \right]
  \end{eqnarray*}
  \begin{enumerate}
  \item if $\alpha < 1$, by subadditivity we have
    \begin{eqnarray*}
      &&\E_\beta\left[\int_{S_+^{d-1}} (\inn{A_n V_{n-1}, y} + \inn{B_n,
          y})^\alpha dl^*_{\beta}(y; \alpha) | \mathcal F_{n-1} \right]\\
      &\leq& \E_\beta\left[\int_{S_+^{d-1}} \inn{A_n V_{n-1}, y}^\alpha
        dl^*_{\beta}(y; \alpha) | \mathcal F_{n-1} \right]
      + \E_\beta\left[\int_{S_+^{d-1}} \inn{B_n, y}^\alpha dl^*_{\beta}(y; \alpha) |
        \mathcal F_{n-1} \right] \\
      &=& \E_\beta\left[|V_{n-1}|^\alpha |A_n \tilde V_{n-1}|^\alpha\int_{S_+^{d-1}}
        \inn{{A_n V_{n-1} \over |A_n V_{n-1}|}, y}^\alpha
        dl^*_{\beta}(y; \alpha) | \mathcal F_{n-1} \right] \\
      && + \E_\beta\left[\int_{S_+^{d-1}} \inn{B_n, y}^\alpha dl^*_{\beta}(y; \alpha) |
        \mathcal F_{n-1} \right] \\
      &=& |V_{n-1}|^\alpha \left\{
        (P_{\alpha, \beta} r_{\beta})(\tilde V_{n-1}; \alpha) +
        {1 \over |V_{n-1}|^\alpha} \E_\beta |B_n|^\alpha r_\beta(\tilde
        B_n; \alpha) \right\} \\
      &=& |V_{n-1}|^\alpha r_\beta(\tilde V_{n-1}; \alpha)\left\{
        \lambda_\beta(\alpha) +
        {1 \over |V_{n-1}|^\alpha r_\beta(\tilde V_{n-1}; \alpha)} \E_\beta
        |B_n|^\alpha r_\beta(\tilde B_n; \alpha) \right\} \\
    \end{eqnarray*}
    By assumption, $\E_\beta|B_n|^\alpha < \infty$; and
    $r_\beta(\tilde B_n; \alpha) < \infty$, $r_\beta(\tilde V_{n-1};
    \alpha) < \infty$ according to Buraczewski and Collamore \cite{BCDZ2014}.
    Hence the infimum of the expression in the curly bracket over all $n \geq 1$ is
    $\lambda_\beta(\alpha) < 1$. Therefore, when $|V_{n-1}|$ is
    sufficiently large, $\rho_{\beta}(\alpha)$ an be chosen such that
    \begin{eqnarray*}
      \rho_{\beta}(\alpha) &<& 1 \\
      \E_\beta \left[ |V_n|^\alpha r_\beta(\tilde V_n; \alpha)  \I{{\mathcal C}^\complement}(V_{n-1})
        | \mathcal F_{n-1} \right] &\leq&
      \rho_\beta(\alpha) |V_{n-1}|^\alpha r_\beta(\tilde V_{n-1}; \alpha) \I{{\mathcal C}^\complement}(V_{n-1})
    \end{eqnarray*}
    where ${\mathcal C}^\complement$ denotes the complement of the set
    $\mathcal C = [-M, M]$ where
    \begin{equation}
      \label{eq:C_set}
      M  \geq \left[
          \E_\beta (|B|^\alpha r_\beta(\tilde B; \alpha)) 
          \over
          [1 - \lambda_\beta(\alpha)] r_\beta(\tilde v; \alpha)
        \right]^{1/\alpha}
    \end{equation}
  \end{enumerate}    
\end{proof}

\begin{remark}
  Iterating \eqref{eq:drift} yields
  \[
  \E_\beta \left[
    |V_n|^\alpha r_\beta(|\tilde V_n|; \alpha)
    \prod_{i=1}^{n-1}\I{{\mathcal C}^\complement}(V_i)\right]
  \leq \rho_\beta(\alpha)^{n-1} |V_1|^\alpha r_\beta(|\tilde V_1|; \alpha) \I{{\mathcal C}^\complement}(V_1)
  \]
  Then it follows
  \[
  \E_\beta \left[
    |V_n|^\alpha r_\beta(|\tilde V_n|; \alpha) \prod_{i=1}^{n}\I{{\mathcal C}^\complement}(V_i)\right]
  \leq \rho_\beta(\alpha)^{n-1} |V_1|^\alpha r_\beta(|\tilde V_1|; \alpha) \I{{\mathcal C}^\complement}(V_1)
  \]
  But $\prod_{i=1}^{n}\I{{\mathcal C}^\complement}(V_i)$ implies $\tau > n$, and in this
  case $|V_n| > M$, where
  \[
  M = \left[
    \E_\beta (|B|^\alpha r_\beta(\tilde B; \alpha)) 
    \over
    (1 - \lambda(\alpha)) r_\beta(\tilde v; \alpha)
  \right]^{1/\alpha}
  \]
  Hence
  \begin{eqnarray}
    \E_\beta \left[
      M^\alpha \inf_{|\tilde V_n|} r_\beta(|\tilde V_n|; \alpha) \1{\tau > n}\right]
    &\leq& \rho_\beta(\alpha)^{n-1} |V_1|^\alpha r_\beta(|\tilde V_1|;
    \alpha) \I{{\mathcal C}^\complement}(V_1) \nonumber \\
    \P_\beta(\tau > n) &\leq& K \rho_\beta(\alpha)^{n-1} \\
    &=& K [b \lambda_{\beta}(\alpha)]^{n-1} \label{eq:ret_time}
  \end{eqnarray}
  for some constant $K$ and some $b > 1$.
\end{remark}

% \begin{lemma}
%   \label{lemma:A_norm_a.s}
%   Assume $\beta > 0$ and $\E \|A\|^{\beta} < \infty$. Then
%   for all $0 < \alpha < \beta$,
%   $\|A\|^{\alpha} < \infty$ almost surely.
% \end{lemma}
% \begin{proof}
%   We need to show
%   \begin{eqnarray*}
%     \P\left(
%       \bigcup_{N=1}^\infty \bigcap_{k=N}^\infty
%     \left\{
%     \|A\|^\alpha \leq k
%     \right\}
%     \right) &=& 1
%   \end{eqnarray*}
%   By Borel-Cantelli lemma, it suffices to show
%   \begin{equation*}
%     \sum_{k=1}^\infty \P(\|A\|^\alpha > k) < \infty
%   \end{equation*}
%   By Markov's inequality
%   \begin{eqnarray*}
%     && \sum_{k=1}^\infty \P(\|A\|^\alpha > k)
%        \leq
%        \sum_{k=1}^\infty
%        {
%        \E \|A\|^{p\alpha}
%        \over
%        k^p
%        }
%   \end{eqnarray*}
%   for some $1 < p < \beta/\alpha$. Since
%   $\E \|A\|^{p\alpha} < \E \|A\|^{\beta} < \infty$,
%   it follows
%   \begin{equation*}
%     \sum_{k=1}^\infty
%     {
%       \E \|A\|^{p\alpha}
%       \over
%       k^p
%     }
%     \leq
%     \sum_{k=1}^\infty
%     {
%       C
%       \over
%       k^p
%     } < \infty
%   \end{equation*}
%   for some constant $C$.
% \end{proof}

% \begin{lemma}
%   \label{lemma:Pi_n_to_alpha_a.s.}
%   Assume $\lambda(\beta) < \infty$, then for all $n \geq 1$, and for
%   all $0 < \alpha < \beta$,
%   \begin{equation*}
%     \|A_{n} \cdots A_{1}\|^\alpha < \infty \text{ a.s.}
%   \end{equation*}
% \end{lemma}
% \begin{proof}
%   By Borel-Cantelli lemma, it suffices to show
%   \begin{eqnarray*}
%     \sum_{k=1}^\infty \P(\|A_{n} \cdots A_{1}\|^\alpha > k) &<& \infty
%     \\
%     \sum_{k=1}^\infty \P(\|A_{n} \cdots A_{1}\|^{p\alpha} > k^p) &<& \infty    
%   \end{eqnarray*}
%   for some $1 < p < \beta/\alpha$. Since
%   \begin{equation*}
%     \lim_{l \to \infty} {1 \over l} \log \E \|A_l \cdots A_1\|^\alpha
%     = \lambda(\alpha)
%   \end{equation*}
%   and $\lambda(\alpha) < \lambda(\beta) < \infty$, we have, when $l$
%   is sufficiently large and for all $a > 1$,
%   \begin{equation*}
%     \E \|A_l \cdots A_1\|^\alpha \leq [a \lambda(\alpha)]^l
%   \end{equation*}
%   Thus by choosing $N$ sufficiently large we have
%   \begin{eqnarray*}
%     && \sum_{k=1}^\infty \P(\|A_{n} \cdots A_{1}\|^{p\alpha} > k^p) \\
%     &\leq& \sum_{k=1}^{\infty} {
%            \E \|A_{n} \cdots A_{1}\|^{p\alpha}
%            \over
%            k^p
%            } \\
%     &\leq& (\E \|A_1\|^{p\alpha})^{n}\1{n \leq N}
%            \sum_{k=1}^\infty {1 \over k^p} +
%            [a \lambda(p\alpha)]^{n}\1{n > N}
%            \sum_{k=1}^\infty {1 \over k^p}
%            < \infty
%   \end{eqnarray*}
% \end{proof}

% \begin{lemma}
%   Assume $\lambda(\beta) < \infty$, then for all $n \geq 1$, and for
%   all $0 < \alpha < \beta$,
%   \begin{equation*}
%     \|A_{T_u} \cdots A_{n+1}\|^\alpha \1{n \leq T_u < \tau}
%     < \infty \text{ a.s.}
%   \end{equation*}
% \end{lemma}
% \begin{proof}
%   Throughout this proof, we use $c, c_1, c_2, \dots$ to denote
%   constants whose values have no significance. Each of them may stand
%   for one or more values depending on the context.

%   By Borel-Cantelli lemma, it suffices to show
%   \begin{equation*}
%     \sum_{k=1}^\infty
%     \P \left(
%       \|A_{T_u} \cdots A_{n+1}\|^\alpha
%       \1{n \leq T_u < \tau} > k
%     \right) < \infty
%   \end{equation*}
%   LHS of the above inequality can be re-written
%   \begin{eqnarray*}
%     &&
%        \sum_{k=1}^\infty
%        \P \left(
%        \|A_{T_u} \cdots A_{n+1}\|^\alpha
%        \1{n \leq T_u < \tau} > k
%        \right) \\
%     &=& \sum_{k=1}^\infty \sum_{l=n}^\infty
%         \P \left(
%         \|A_l \cdots A_{n+1}\|^\alpha
%         \1{T_u = l}
%         \1{\tau > l} > k
%         \right) \\
%     &\leq& \sum_{k=1}^\infty \sum_{l=n}^\infty
%            {
%            \E (\|A_l \cdots A_{n+1}\|^{p \alpha}
%            \1{T_u = l} \1{\tau > l})
%            \over
%            k^p
%            }
%   \end{eqnarray*}
%   for some $1 < p < \beta/\alpha$.
%   As shown in lemma \ref{lemma:Pi_n_to_alpha_a.s.},
%   $\|A_l \cdots A_{n+1}\|^{p \alpha} < \infty$ a.s. Hence
%   \[
%   \E (\|A_l \cdots A_{n+1}\|^{p \alpha}
%   \1{T_u = l} \1{\tau > l}) \leq c \P(\tau > l)
%   \]
%   Applying \eqref{eq:ret_time} gives
%   \[
%   \P(\tau > l) \leq c_1 [a \lambda(\theta)]^{l-1}
%   \]
%   for some $0 < \theta < \xi$ and $a > 1$ such that $a \lambda(\theta) <
%   1$. Thus it follows
%   \begin{eqnarray*}
%     && \sum_{k=1}^\infty \sum_{l=n}^\infty
%            {
%            \E (\|A_l \cdots A_{n+1}\|^{p \alpha}
%            \1{T_u = l} \1{\tau > l})
%            \over
%            k^p
%            } \\
%     &\leq& \sum_{k=1}^\infty {c \over k^p}
%            \sum_{l=n}^\infty [a \lambda(\theta)]^{l-1} \\
%     &=& c {
%         [a \lambda(\theta)]^{n-1}
%         \over
%         1 - a \lambda(\theta)
%         }
%         \sum_{k=1}^\infty {1 \over k^p}
%         < \infty
%   \end{eqnarray*}
% \end{proof}

\begin{theorem}
  The estimator $\mathcal E_u$ has bounded relative error, i.e.
  \begin{equation*}
    \limsup_{u \to \infty} {\var(\mathcal E_u) \over [\P(|V| > u)]^2} < \infty
  \end{equation*}
  under one of the following conditions:
  \begin{enumerate}
  \item $\E \|A\|^{-\xi} \leq \lambda(-\xi) < \infty$, $\exists h > 1$,
    $\E\|A\|^{h\xi} < \infty$,
    $\forall \theta > 0, \E |B|^{\theta} < \infty$ and
    \begin{equation}
      \label{eq:deepness}
      -\inf_{\alpha \in \mathbb R} \Phi(\alpha)
      >
      {
        h+1
        \over
        h-1
      } \Lambda(-\xi)
      +
      \max\left\{
      {
        2 \Phi(h\xi) - (h+1) \Phi(-\xi)
        \over
        h-1
      },
      -\Phi(-\xi)
      \right\}
    \end{equation}
    where
    \[
    \Phi(\alpha) := \log \E \|A\|^{\alpha}
    \]
    \label{assumptions:1}
  \item $\lambda(-\xi) = \infty$, $\exists h > 1$,
    $\lambda(h\xi) \leq \E\|A\|^{h\xi} < \infty$. Moreover, $\sup |B|
    < \infty$.
  \end{enumerate}
\end{theorem}
\begin{proof}
  The assertion is equivalent to
  \[
  \limsup_{u \to \infty} {\E_{\mathcal D} \mathcal E_u^2 \over [\P(|V|
    > u)]^2} < \infty
  \]
  By Kesten's theorem \cite{Kesten1973}, $\P(|V| > u) \sim C
  u^{-\xi}$. Hence, to prove the assertion, one needs to check
  $\limsup_{u \to \infty} u^{2\xi}\E_{\mathcal D} \mathcal E_u^2 <
  \infty$, i.e.
  \[
  \limsup_{u \to \infty} \E_{\mathcal D}  \left[u^{2\xi}
    N_u^2 \1{T_u < \tau} e^{-2\xi S_{T_u}} {r^2(\tilde V_0; \xi)
      \over r^2(x_{T_u}; \xi)}\right] < \infty
 \]
 Using the fact $|V_{T_u}| > u$, and that $r(\cdot; \xi)$ is bounded
 from above and below, it suffices to show
 \begin{eqnarray}
   f(\xi) &=& \limsup_{u \to \infty} \E_{\mathcal D} \left[
     \left|
       \sum_{n=0}^{T_u}
       \frac{
         N_u^{1/\xi} A_{T_u} \cdots A_{n+1} B_n 
       }{
         |A_{T_u} \cdots A_1 V_0|
       }
       \1{T_u < \tau}
     \right|^{2 \xi}
   \right] < \infty \label{eq:efficiency_target}
 \end{eqnarray}
  In the rest of the proof, we write $c, c_1, c_2, \dots$ for
  constants whose values have no importance and depend on the
  context.
  \begin{enumerate}
  \item We first consider the case with condition
    \ref{assumptions:1}. Since $\xi > 1$, Minkowski's inequality gives
    \begin{eqnarray}
      f(\xi) &\leq& \limsup_{u \to \infty}
      \left\{
        \sum_{n=0}^{\infty}
        \left[
          \E_{\mathcal D} \left|
            N_u^{1/\xi}
            \frac{
              A_{T_u} \cdots A_{n+1} B_n 
            }{
              |A_{T_u} \cdots A_1 V_0|
            }
            \1{n \leq T_u < \tau}
          \right|^{2 \xi}
        \right]^{1/2\xi}
      \right\}^{2\xi} \nonumber \\
      &\leq& c \limsup_{u \to \infty}
      \left\{
        \sum_{n=0}^{\infty}
        \left[
          \E_{-\xi} N_u^2 
          |A_{T_u} \cdots A_{n+1} B_n|^{2\xi}
          \lambda(-\xi)^{T_u} \right. \right.\times \nonumber \\
      &&   \left. \left.
          \1{n \leq T_u < \tau}
        \right]^{1/2\xi}
      \right\}^{2\xi} \label{eq:xi_above_half_prel}
    \end{eqnarray}
    By H\"older's inequality,
    \begin{eqnarray}
      && \left[ \E_{-\xi} N_u^2 
        |A_{T_u} \cdots A_{n+1} B_n|^{2\xi}
        \lambda(-\xi)^{T_u}
        \1{n \leq T_u < \tau} \right]^{1/2\xi} \nonumber \\
      &\leq& 
      \left[ \E_{-\xi} N_u^2 
        \|A_{T_u} \cdots A_{n+1}\|^{2\xi} |B_n|^{2\xi}
        \lambda(-\xi)^{T_u}
        \1{n \leq T_u < \tau} \right]^{1/2\xi} \nonumber \\
      &\leq& 
      \left[\E_{-\xi}\left( \|A_{T_u} \cdots A_{n+1}\|^{2s\xi}
          \lambda(-\xi)^{s T_u}
          \1{n \leq T_u < \tau}\right)\right]^{1/2s\xi}
      \times\nonumber \\
      && \left(\E_{-\xi}|B_n|^{2r\xi}\right)^{1/2r\xi}
      \left[\E_{-\xi}(N_u^{2r}\1{n \leq T_u < \tau})\right]^{1/2r\xi}
      \label{eq:xi_above_half}
    \end{eqnarray}
    where $1/s + 2/r = 1$. For the first factor we have

    \begin{eqnarray*}
      && \E_{-\xi}\left(\|A_{T_u} \cdots A_{n+1}\|^{2s\xi}
        \lambda(-\xi)^{s T_u}
        \1{n \leq T_u < \tau}\right) \\
      &=& \sum_{k=n}^\infty \E_{-\xi} \left(
        \|A_k \cdots A_{n+1}\|^{2s\xi}
        \lambda(-\xi)^{s k}
        \1{T_u = k} \1{k < \tau}\right)  \\
      &\leq& \sum_{k=n}^\infty
      \left(\E_{-\xi}
        \|A_k \cdots A_{n+1}\|^{2sp\xi}
      \right)^{1/p}
      \P_{-\xi}(\tau > k)^{1/q}
      \lambda(-\xi)^{sk}
    \end{eqnarray*}
    In the last step we have used H\"older's inequality with
    \begin{eqnarray*}
      p &=& {h + 1 \over 2s} \\
      q &=& (1 - 1/p)^{-1}
    \end{eqnarray*}
    Note
    \[
    \E_{-\xi} \|A\|^{2sp\xi} = {
      \E \|A\|^{(2sp-1)\xi}
      \over
      \E \|A\|^{-\xi}
    } = {
      \E \|A\|^{h\xi}
      \over
      \E \|A\|^{-\xi}
    }
    \]
    Since $\E \|A\|^{-\xi} < \lambda(-\xi) < \infty$ and
    $\E \|A\|^{h\xi} < \infty$,
    \[
    \E_{-\xi} \|A\|^{2sp\xi} < \infty    
    \]
    Then, as discussed by Buraczewski, Damek and Mikosch
    \cite{BuraczewskiDamekMikosch2015} (\S 4.4.3), for fixed $n$
    \[
    \lim_{k \to \infty}
    \left( \E_{-\xi}
      \|A_k \cdots A_{n+1}\|^{2sp\xi}
    \right)^{1/(k-n)} = \lambda_{-\xi}(2sp\xi) < \infty
    \]
    Hence $\forall a > 1$, $\exists N \geq 1$ such that $\forall k
    \geq n + N$,
    \[
    (\E_{-\xi}\|A_{k} \cdots A_{n+1}\|^{2sp\xi})^{1/(k-n)} <
    a \lambda_{-\xi}(2sp\xi)
    \]
    Meanwhile, for $k \in \{n+1, \dots, n+N-1\}$, due to the
    independence of $A_{n+1}, A_{n+2}, \dots, A_k$ we have
    \begin{eqnarray*}
      && \E_{-\xi} \|A_k \dots A_{n+1}\|^{2sp\xi} \\
      &\leq& \left[\E_{-\xi} \|A_1\|^{2sp\xi}\right]^{k-n}
    \end{eqnarray*}
    Therefore we get
    \begin{eqnarray*}
      && \sum_{k=n}^\infty
      \left(\E_{-\xi}
        \|A_k \cdots A_{n+1}\|^{2sp\xi}
      \right)^{1/p}
      \P_{-\xi}(\tau > k)^{1/q}
      \lambda(-\xi)^{sk} \\
      &\leq& \sum_{k=n}^{n+N-1} \left(
        \E_{-\xi} \|A\|^{2sp\xi}
      \right)^{k-n \over p} \P_{-\xi}(\tau > k)^{1/q}
      \lambda(-\xi)^{sk} \\
      && + \sum_{k=n+N}^\infty \left[
        a \lambda_{-\xi}(2sp\xi)
      \right]^{k-n \over p} \P_{-\xi}(\tau > k)^{1/q}
      \lambda(-\xi)^{sk} \\
      &=& S_1 + S_2
    \end{eqnarray*}
    Let $\omega := \E_{-\xi} \|A\|^{2sp\xi} < \infty$. By applying
    \eqref{eq:ret_time} with $\beta = -\xi$, we get
    \[
    \P_{-\xi}(\tau > k) \leq K [a \lambda_{-\xi}(\alpha)]^{k-1}
    \]
    where $\alpha$ is chosen appropriately and $a$ chosen sufficiently
    close to 1 such that
    \[
    a \lambda_{-\xi}(\alpha) \leq a {
      \E \|A\|^{\alpha - \xi}
      \over
      \E \|A\|^{-\xi}
    } < 1
    \]
    Thus
    \begin{eqnarray}
      S_1 &\leq& c_1 \omega^{-n/p}
      \sum_{k=n}^{n+N-1} \omega^{k/p}
      [a \lambda_{-\xi}(\alpha)]^{k/q}
      \lambda(-\xi)^{sk} \nonumber \\
      &=& c_1 \left[
        a^{1/q} \lambda(-\xi)^s \lambda_{-\xi}(\alpha)^{1/q}
      \right]^{n} \label{eq:S_1}
    \end{eqnarray}
    We note
    \begin{eqnarray*}
      && \lambda(-\xi)^s \lambda_{-\xi}(\alpha)^{1/q}\\
      &\leq& \lambda(-\xi)^s \left[
        {
          \E \|A\|^{\alpha - \xi}
          \over
          \E \|A\|^{-\xi}
        }
      \right]^{1/q}
    \end{eqnarray*}
    By assumption \eqref{eq:deepness}
    \[
    \lambda(-\xi)^s \lambda_{-\xi}(\alpha)^{1/q} < 1
    \]
    when $s$ is sufficiently close to 1. Choose $a$ sufficiently
    close to 1 such that
    \begin{equation}
      \label{eq:S_1_kern}
      a^{1/q} \lambda(-\xi)^s \lambda_{-\xi}(\alpha)^{1/q} < 1
    \end{equation}
    As for $S_2$, since
    $\lambda_{-\xi}(2sp\xi) \leq \E_{-\xi}\|A\|^{2sp\xi} = \omega$
    \begin{eqnarray*}
      S_2 &\leq& c_2 \sum_{k=n+N}^\infty
      (a \omega)^{k-n \over p}
      [a \lambda_{-\xi}(\alpha)]^{k/q}
      \lambda(-\xi)^{sk} \\
      &=& c_2 (a \omega)^{-n/p}
      \sum_{k=n+N}^\infty \left[
        (a \omega)^{1/p}
        (a \lambda_{-\xi}(\alpha))^{1/q}
        \lambda(-\xi)^s
      \right]^k
    \end{eqnarray*}
    When $a$ and $s$ are chosen sufficiently close to 1,
    \[
    (a \omega)^{1/p}
    (a \lambda_{-\xi}(\alpha))^{1/q}
    \lambda(-\xi)^s < 1
    \]
    by assumption \eqref{eq:deepness}. Thus we have
    \begin{equation}
      \label{eq:S_2}
      S_2 \leq c_2 \left[
        a^{1/q} \lambda(-\xi)^s
        \lambda_{-\xi}(\alpha)^{1/q}
      \right]^n
    \end{equation}
    The expression in the square bracket is the same as LHS of
    \eqref{eq:S_1_kern} and less than 1. As for the term
    $\E_{-\xi}|B_n|^{2s\xi}$ we have
    \begin{eqnarray}
      \E_{-\xi}|B_n|^{2s\xi} &=& \E|B_n|^{2s\xi} < \infty
      \label{eq:B_n}
    \end{eqnarray}
    by assumption. Finally,
    \begin{eqnarray*}
      && \E_{-\xi}(N_u^{2r}\1{n \leq T_u < \tau}) \\
      &\leq& \E_{-\xi} \tau^{2r} \1{n < \tau} \\
      &=& \sum_{k=n+1}^\infty k^{2r}
      \P_{-\xi}(\tau > k-1) \\
    \end{eqnarray*}
    Using \eqref{eq:ret_time} with $\beta = -\xi$ we get
    \begin{eqnarray*}
      \P_{-\xi}(\tau > k-1) &\leq&
      c [a \lambda_{-\xi}(\alpha)]^{k-2}
    \end{eqnarray*}
    Note $a \lambda_{-\xi}(\alpha) < 1$. It follows
    \begin{equation}
      \label{eq:N_u}
      \E_{-\xi}(N_u^{2r}\1{n \leq T_u < \tau}) \leq
      c \left[
        a \lambda_{-\xi}(\alpha)
      \right]^{n}
    \end{equation}
    From \eqref{eq:S_1}, \eqref{eq:S_1_kern}, \eqref{eq:S_2},
    \eqref{eq:B_n} and \eqref{eq:N_u}, it is clear $f(\xi) < \infty$.

  \item Now we consider the case $\lambda(-\xi) = \infty$ under
    the second assumption.
    Since
    \[
    V_n = \sum_{i=0}^n A_n \cdots A_{i+1} B_i
    \]
    it follows
    \begin{eqnarray*}
      |V_n|\1{\tau > n} &\leq&
      \sum_{i=0}^{n} \|A_n \cdots A_{i+1}\| |B_i| \\
      \|A_n \cdots A_1\|^{-1} \1{\tau > n}
      &\leq& |V_n|^{-1} \1{\tau > n}
      \left[
        |B_0| + \sum_{i=1}^n {
          \|A_n \cdots A_{i+1}\|
          \over
          \|A_n \cdots A_{1}\|
        } |B_i|
      \right] \\
      &\leq& {1 \over M}
      \left[
        |B_0| + \sum_{i=1}^n {
          \|A_n \cdots A_{i+1}\|
          \over
          \|A_n \cdots A_{1}\|
        } |B_i| \1{\tau > n}
      \right]
    \end{eqnarray*}
    Note
    \[
    \|A_n \dots A_{i+1} A_i \cdots A_1\| \geq
    C^{-1} \|A_n \cdots A_{i+1}\|
    \|A_i \cdots A_{1}\|
    \]
    for some $C > 1$. We have
    \begin{equation}
      \label{eq:lower_bound}
      \|A_n \cdots A_1\|^{-1} \1{\tau > n}
      \leq
      {1 \over M} \left[
        |B_0| + \sum_{i=1}^n {
          C |B_i|
          \over
          \|A_i \cdots A_1\|
        }  \1{\tau > n}
      \right]
    \end{equation}
    Let
    \[
    J_k = \|A_k \cdots A_1\|^{-1} \1{\tau > n}
    \]
    We obtain
    \begin{eqnarray*}
      \left(
        \E J_n^\zeta
      \right)^{1/\zeta} &\leq& \left[
        \E \left(
          {|B_0| \over M}
          + {C \over M} \sum_{i=1}^n |B_i| J_i
        \right)^\zeta
        \right]^{1/\zeta}
    \end{eqnarray*}
    Using Minkowski's inequality and the independence of $B_i$ and
    $A_i, \dots, A_1$ the above yields
    \begin{eqnarray}
      (\E J_n^\zeta)^{1/\zeta} &\leq&
      {|B_0| \over M} + {C \over M}
      \sum_{i=1}^n
      (\E |B_i|^\zeta)^{1/\zeta}
      (\E J_i^\zeta)^{1/\zeta}
      \label{eq:neg_pow_ub} \\
      &=& h_1 + h_2 \sum_{i=1}^{n-1} (\E J_i^\zeta)^{1/\zeta}
      \nonumber
    \end{eqnarray}
    where
    \begin{eqnarray*}
      h_1 &=& {|B_0| \over M} \\
      h_2 &=& {C \over M} (\E |B_1|^\zeta)^{1/\zeta}
    \end{eqnarray*}
    Since
    \begin{eqnarray*}
      V_1 &=& A_1 V_0 + B_1 \\
      |V_1| &\leq& \|A_1\| |V_0| + |B_1| \\
      \end{eqnarray*}
      and by assumption $\E (|B|/\|A\|)^\zeta < \infty$, we have
      \begin{eqnarray}
        (\E J_1^\zeta)^{1/\zeta} &=&
        \left[
        \E (\|A_1\|^{-\zeta}\1{\tau > n})
      \right]^{1/\zeta} \nonumber \\
      &\leq&
      {|V_0|\over M} \E \left[\left(
        1 + {|B_1| \over |V_0| \|A_1\|}
      \right)^\zeta
      \1{\tau > n}\right]^{1/\zeta}< \infty
    \label{eq:J_1}
    \end{eqnarray}
    Let
    \[
    y_1 = 
    {|V_0|\over M} \E \left[\left(
        1 + {|B_1| \over |V_0| \|A_1\|}
      \right)^\zeta \1{\tau > n}\right]^{1/\zeta}
    \]
    and
    \begin{equation}
      \label{eq:y_n}
      y_n = h_1 + h_2 \sum_{i=1}^{n-1} y_i      
    \end{equation}
    Then \eqref{eq:neg_pow_ub}, \eqref{eq:y_n} and \eqref{eq:J_1}
    yield
    \begin{equation}
      \label{eq:J_n_2}
      (\E J_n^\zeta)^{1/\zeta} \leq y_n      
    \end{equation}
    Meanwhile \eqref{eq:y_n} gives, $\forall n \geq 1$,
    \begin{equation}
      \label{eq:y_n_2}
      y_n = {y_1 \over (1 - h_2)^{n-1}}
    \end{equation}
    Now using Minkowski's inequality on RHS of
    \eqref{eq:efficiency_target} leads to
      \begin{eqnarray*}
        f(\xi) &\leq& \limsup_{u \to \infty}
        \left\{
          \sum_{n=0}^{\infty}
          \left[
            \E_{\mathcal D} \left|
              N_u^{1/\xi}
              \frac{
                A_{T_u} \cdots A_{n+1} B_n 
              }{
                |A_{T_u} \cdots A_1 V_0|
              }
              \1{n \leq T_u < \tau}
            \right|^{2 \xi}
          \right]^{1/2\xi}
        \right\}^{2\xi} \\
        &\leq& c \limsup_{u \to \infty}
        \left\{
          \sum_{n=0}^{\infty}
          \left[
            \E \left(
              N_u^2
              \frac{
                |A_{T_u} \cdots A_{n+1} B_n|^{2\xi}
              }{
                |A_{T_u} \cdots A_1 V_0|^\xi
              }
              \1{n \leq T_u < \tau}
            \right)
          \right]^{1/2\xi}
        \right\}^{2\xi}
      \end{eqnarray*}
      By H\"older's inequality we have
      \begin{eqnarray*}
        &&
        \E \left(
          N_u^2
          \frac{
            |A_{T_u} \cdots A_{n+1} B_n|^{2\xi}
          }{
            |A_{T_u} \cdots A_1 V_0|^\xi
          }
          \1{n \leq T_u < \tau}
        \right) \\
        &\leq&
        (\E N_u^{2r}\1{n \leq T_u < \tau})^{1/r}
        \left(
          \E {
            |A_{T_u} \cdots A_{n+1} B_n|^{2s \xi}
            \over
            |A_{T_u} \cdots A_1 V_0|^{s \xi}
          } \1{n \leq T_u < \tau}
        \right)^{1/s}
        (\E \1{n \leq T_u < \tau})^{1/r} \\
        &\leq&
        c
        (\E N_u^{2r}\1{n \leq T_u < \tau})^{1/r}
        \left(
          \E {
            \|A_{T_u} \cdots A_{n+1} \|^{2s\xi} |B_n|^{2s \xi}
            \over
            \|A_{T_u} \cdots A_{n+1} \|^{s\xi} \|A_n\|^{s\xi}
            \|A_{n-1} \cdots A_1\|^{s\xi} |V_0|^{s \xi}
          } \1{n \leq T_u < \tau}
        \right)^{1/s} \times \\
        &&
        (\E \1{n \leq T_u < \tau})^{1/r} \\
        &\leq&
        c
        (\E N_u^{2r}\1{n \leq T_u < \tau})^{1/r}
        \left(
          \E {
            \|A_{T_u} \cdots A_{n+1} \|^{s\xi}
            \over
            \|A_{n-1} \cdots A_1\|^{s\xi}
         }
         \1{n \leq T_u < \tau}
          \right)^{1/s}         
          \left(
          \E {
            |B_n|^{2s\xi}
            \over
            |A_n|^{2\xi}
          }
        \right)^{1/s} \times \\
        &&
        (\E \1{n \leq T_u < \tau})^{1/r}
      \end{eqnarray*}
      where $r$ and $s$ satisify $1/s + 2/r = 1$.
      The last line follows from the second last using the fact that
      each $A_n$ and $B_n$ is independent.

      Observe
      \begin{eqnarray*}
        &&
        \E
        \left(
          {
            \|A_{T_u} \cdots A_{n+1} \|^{s\xi}
            \over
            \|A_{n-1} \cdots A_1\|^{s\xi}
          }
          \1{n \leq T_u < \tau}
        \right) \\
        &=&
        \sum_{l=n}^\infty
        \E
        \left(
          {
            \|A_{l} \cdots A_{n+1} \|^{s\xi}
            \over
            \|A_{n-1} \cdots A_1\|^{s\xi}
          }
        \1{\tau > l} \1{T_u = l}
      \right)
      \end{eqnarray*}
      Becasue $\|A_l \cdots A_{n+1}\|$ and
      $\|A_{n-1} \cdots A_1\|$ are independent of each other,
      we have
      \begin{eqnarray*}
        &&
        \sum_{l=n}^\infty
        \E
        \left(
          {
            \|A_{l} \cdots A_{n+1} \|^{s\xi}
            \over
            \|A_{n-1} \cdots A_1\|^{s\xi}
          }
          \1{\tau > l} \1{T_u = l}
        \right) \\
        &\leq&
        \sum_{l=n}^\infty
        \E (\|A_l \cdots A_{n+1}\|^{s \xi}) \1{\tau > l}
        \E (\|A_{n-1} \cdots A_{1}\|^{- s\xi}) \1{\tau > l} \\
        &\leq&
        c \sum_{l=n}^\infty
        \E (|A_l \cdots A_{n+1} X_{n}|^{s \xi}\1{\tau > l})
        \E (\|A_{n-1} \cdots A_{1}\|^{- s\xi} \1{\tau > l})
      \end{eqnarray*}
      Using \eqref{eq:J_n_2} and \eqref{eq:y_n_2}, RHS of the above
      inequality is bounded by
      \begin{eqnarray*}
        c \sum_{l=n}^\infty
        \left[{y_1 \over (1 - h_2)^{n-2}}\right]^{s\xi}
        \E (|A_l \cdots A_{n+1} X_{n}|^{s \xi}\1{\tau > l})
      \end{eqnarray*}
      By changing to the $s\xi$-shifted measure we get
      \begin{eqnarray*}
        &&
        c \sum_{l=n}^\infty
        \left[{y_1 \over (1 - h_2)^{n-2}}\right]^{s\xi}
        \E (|A_l \cdots A_{n+1} X_{n}|^{s \xi}\1{\tau > l}) \\
        &\leq&
        c \sum_{l=n}^\infty
        \left[{y_1 \over (1 - h_2)^{n-2}}\right]^{s\xi}        
        \E_{s\xi} \left[
          {r(X_n) \over r(X_l)}
          \1{\tau > l}
        \right]
        \lambda(s\xi)^{l-n}
      \end{eqnarray*}
      % Here and in the following we used the convention
      % $\|A_i A_{i-1}\cdots A_j\| = 1$ if $i < j$. We have
      % \begin{eqnarray*}
      %   && \E \left(
      %     \|A_{T_u} \cdots A_{n+1}\|^\zeta 
      %     \1{\|A_{n-1} \cdots A_1\| \geq 1}
      %     \1{n \leq T_u < \tau}
      %   \right) \\
      %   &\leq&
      %   \sum_{k=n}^\infty
      %   \E \left(
      %     \|A_k \cdots A_{n+1}\|^\zeta \1{T_u = k} \1{\tau > k}
      %   \right)  \\
      %   &\leq& 
      %   \sum_{k=n}^\infty
      %   \E \left(
      %     \|A_k \cdots A_{n+1}\|^\zeta \1{\tau > k}
      %   \right) \\
      %   &\leq&
      %   \sum_{k=n}^\infty
      %   \E \left(
      %   \|A_k\|^\zeta \|A_{k-1} \cdots A_{n+1}\|^\zeta \1{\tau > k}
      %   \right) \\
      %   &\leq&
      %   \sum_{k=n}^\infty
      %   \E (\|A_{k-1} \cdots A_{n+1}\|^\zeta)
      %   \E (\|A_k\|^\zeta \1{\tau > k})
      % \end{eqnarray*}
      % where the last line follows from the fact that
      % $A_{k}, \dots, A_{n+1}$ are independent of each other. Since
      % $\E \|A_k\|^\zeta = \E \|A_1\|^\zeta < \infty$, $\|A_k\| <
      % \infty$ almost surely. Hence
      % \begin{equation*}
      %   \E (\|A_k\|^\zeta \1{\tau > k}) < c_1 \P(\tau > k) \text{ a.s.}
      % \end{equation*}
      % for some constant $c_1$. Applying \eqref{eq:ret_time} with
      % $\beta = 0$ gives
      % \begin{equation*}
      %   \P(\tau > k) \leq c_2 [a \lambda(\alpha)]^{k-1}
      % \end{equation*}
      % for some $\alpha \in (0, \xi))$ such that $\lambda(\alpha) < 1$,
      % for all $a \in (1, 1/\lambda(\alpha))$ and some $c_2 > 0$.
      % Moreover,
      % \begin{equation*}
      %   \lim_{k \to \infty}
      %   (\E \|A_{k} \cdots A_{n+1}\|^{\zeta})^{1/(k-n)}
      %   = \lambda(\zeta)
      % \end{equation*}
      % So for all $a > 1$, when $N$ is sufficiently large and
      % $k > n +N$, we have
      % \begin{equation*}
      %   \E \|A_k \cdots A_{n+1}\|^{\zeta} \leq [a \lambda(\zeta)]^{k-n}
      % \end{equation*}
      % Thus we obtain
      % \begin{eqnarray*}
      %   &&
      %   \sum_{k=n}^\infty
      %   \E (\|A_{k-1} \cdots A_{n+1}\|^\zeta)
      %   \E (\|A_k\|^\zeta \1{\tau > k}) \\
      %   &\leq&
      %   c \sum_{k=n}^\infty [a \lambda(\alpha)]^{k-1}
      %   \E \|A_{k-1} \cdots A_{n+1}\|^\zeta \\
      %   &\leq&
      %   c \sum_{k=n}^{n+N}
      %   [a \lambda(\alpha)]^{k-1}
      %   [
      %   (\E \|A_1\|^\zeta)^{k-1-n} \1{k-1 \geq n+1} + 1
      %   ] + \\
      %   &&
      %   c \sum_{k=n+N+1}^{\infty}
      %   [a \lambda(\alpha)]^{k-1}
      %   [a \lambda(\zeta)]^{k-1-n} \\
      %   &=& c [a \lambda(\alpha)]^n
      % \end{eqnarray*}
      % The last series converges because $\alpha$ can be chosen
      % appropriately and $a > 1$ chosen so close to 1 that
      % $a^2 \lambda(\zeta) \lambda(\alpha) < 1$.
    \end{enumerate}
\end{proof}


\bibliographystyle{unsrt}
\bibliography{../../thesis/econophysics}
\end{document}
